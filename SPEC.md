# 線稿塗色工具專案規格文件

## 專案目標
建立一個純前端的線稿塗色工具，讓使用者可以：
1. 獲取隨機圖片並自動轉換為線稿
2. 使用各種工具為線稿上色
3. 儲存完成的作品
4. 可直接部署到 GitHub Pages

## 技術棧
- 純前端實現（HTML, CSS, JavaScript）
- 使用 CDN 引入所有依賴
- 主要依賴項：
  - Fabric.js - 用於畫布操作
  - Bootstrap - UI 框架
  - Font Awesome - 圖示

## 功能列表和實現狀態

### 1. 圖片生成功能 ⚠️ (部分完成，待修復)
- [x] 使用 Unsplash API 獲取隨機圖片（已完成）
- [x] 支援不同圖片類別選擇（動物、自然、食物、物品）（已完成）
- [ ] 圖片轉換為線稿功能（待修復）
  - 已實作 Sobel 邊緣檢測算法
  - 待解決：跨域存取問題
  - 待解決：圖片處理效果優化

### 2. 繪圖工具 ✅
- [x] 畫筆工具（自由繪製）
- [x] 橡皮擦工具
- [x] 填充工具（區域填色）
- [x] 顏色選擇器
- [x] 筆刷大小調整

### 3. 編輯功能 ✅
- [x] 復原功能（支援最多 20 步）
- [x] 清除畫布
- [x] 儲存作品（PNG 格式）

### 4. 使用者介面 ✅
- [x] 響應式設計
- [x] 工具面板
- [x] 載入動畫
- [x] 操作按鈕

## 當前開發重點
1. 修復線稿生成功能
   - 改善跨域存取設定
   - 優化邊緣檢測演算法參數
   - 加強錯誤處理機制

## 後續開發計畫
1. [ ] 圖層支援
2. [ ] 更多濾鏡效果
3. [ ] 自定義線稿效果參數
4. [ ] 作品庫功能（使用 LocalStorage）

## 已知問題
1. 填充工具在某些複雜的線稿區域可能會有溢出現象
2. 畫布縮放時可能會影響筆刷大小的準確性
3. 線稿生成功能目前無法正常運作，需要修復
4. 某些瀏覽器可能存在跨域資源存取（CORS）問題

## 技術筆記

### API 設定
1. Unsplash API
   - Access Key 需要在 config.js 中設定
   - 目前使用的 API 端點：`https://api.unsplash.com/photos/random`
   - 支援的參數：
     - query: 圖片類別
     - orientation: 圖片方向

### 線稿生成演算法筆記
1. 使用 Sobel 邊緣檢測
   - 目前閾值：30（可調整範圍：20-50）
   - 線條增強係數：1.5（可調整範圍：1.0-2.0）
2. 圖片預處理
   - 轉換為灰度
   - 對比度增強：150%

## 環境設定說明

### 必要步驟
1. 申請 Unsplash API 存取金鑰：
   - 網址：https://unsplash.com/developers
   - 將金鑰設定在 config.js 中的 CONFIG.UNSPLASH_ACCESS_KEY

### 部署步驟
1. 克隆專案到本地
2. 更新 config.js 中的 API 金鑰
3. 將整個資料夾上傳至 GitHub 儲存庫
4. 啟用 GitHub Pages

## 開發注意事項
1. 保持純前端實現，不添加後端依賴
2. 所有外部庫都使用 CDN 版本
3. 確保代碼兼容主流瀏覽器
4. 保持響應式設計，支援不同螢幕尺寸
5. 圖片處理相關的操作需要考慮效能問題

## 最後更新
- 日期：2025年5月19日
- 主要更新：記錄線稿生成功能的問題和修復進度
- 下一步計畫：修復線稿生成功能並優化圖片處理效果